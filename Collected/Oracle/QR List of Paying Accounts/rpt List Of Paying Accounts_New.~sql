select H.SHOP_CODE,
       H.ORIGINAL_ACCT_NO,
       H.ACCT_NO,
       H.ACTUAL_SALES_DATE H.SALES_DATE,
       H.CUSTOMER,
       H.MONTHLY_PAY,
       H.COLLECTION,
       H.ARR_AMT,
       H.ARR_MON,
       H.TEL_NO,
       H.DEL_MON,
       H.ACT_OUT_BAL,
       (SELECT P.AMOUNT FROM IFSAPP.HPNRET_PAY_RECEIPT_TAB P WHERE PP.VOUCHER_DATE BETWEEN TO_DATE('&FROM_DATE', 'YYYY/MM/DD') AND TO_DATE('&TO_DATE', 'YYYY/MM/DD'))
  from HPNRET_FORM249_ARREARS_TAB H
 WHERE H.YEAR =
       EXTRACT(YEAR FROM
               ADD_MONTHS(TO_DATE('&FROM_DATE', 'YYYY/MM/DD'), -1))
   AND H.PERIOD =
       EXTRACT(MONTH FROM
               ADD_MONTHS(TO_DATE('&FROM_DATE', 'YYYY/MM/DD'), -1))
   AND H.SHOP_CODE LIKE '&SHOP_CODE'
   AND H.ACT_OUT_BAL > 0
