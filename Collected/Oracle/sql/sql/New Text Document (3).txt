select
t.SITE_ID,
h.LEVEL_ID,
h.DESCRIPTION,
HIGHER_LEVEL,
'AREA_CODE' AREA 
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY t,
IFSAPP.HPNRET_LEVEL h
where 
t.LEVEL_ID=h.LEVEL_ID
and t.HIGHER_LEVEL='24'
union all

select
t.SITE_ID,
h.LEVEL_ID,
h.DESCRIPTION,
HIGHER_LEVEL,
'AREA_CODE_level1' AREA 
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY t,
IFSAPP.HPNRET_LEVEL h
where 
t.LEVEL_ID=h.LEVEL_ID
and t.HIGHER_LEVEL in(
select h.LEVEL_ID
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY h
where  h.HIGHER_LEVEL='24'
)

union all


select
t.SITE_ID,
h.LEVEL_ID,
h.DESCRIPTION,
HIGHER_LEVEL,
'AREA_CODE_level2' AREA 
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY t,
IFSAPP.HPNRET_LEVEL h
where 
t.LEVEL_ID=h.LEVEL_ID
and t.HIGHER_LEVEL in(
select
h.LEVEL_ID
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY t,
IFSAPP.HPNRET_LEVEL h
where 
t.LEVEL_ID=h.LEVEL_ID
and t.HIGHER_LEVEL in(
select h.LEVEL_ID
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY h
where  h.HIGHER_LEVEL='24'
)
)


union all

select
t.SITE_ID,
h.LEVEL_ID,
h.DESCRIPTION,
HIGHER_LEVEL,
'AREA_CODE_level3' AREA 
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY t,
IFSAPP.HPNRET_LEVEL h
where 
t.LEVEL_ID=h.LEVEL_ID
and t.HIGHER_LEVEL in
(

select

h.LEVEL_ID
 
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY t,
IFSAPP.HPNRET_LEVEL h
where 
t.LEVEL_ID=h.LEVEL_ID
and t.HIGHER_LEVEL in(
select
h.LEVEL_ID
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY t,
IFSAPP.HPNRET_LEVEL h
where 
t.LEVEL_ID=h.LEVEL_ID
and t.HIGHER_LEVEL in(
select h.LEVEL_ID
from 
IFSAPP.HPNRET_LEVEL_HIERARCHY h
where  h.HIGHER_LEVEL='24'
)
)
)