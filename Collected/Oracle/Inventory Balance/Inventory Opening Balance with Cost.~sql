--***** Inventory Opening Balance with Cost
select t.year,
       t.period,
       t.site,
       t.part_no,
       sum(t.closing_bal) closing_bal,
       sum(t.in_transit) in_transit,
       avg(decode(t.location, 'NORMAL', t.cost, 0)) NORMAL_COST,
       sum(decode(t.location, 'TRANSIT', t.cost, 0)) TRANSIT_COST,
       sum(decode(t.location, 'REVERTS', t.cost, 0)) REVERTS_COST,
       sum(decode(t.location, 'DAMAGE', t.cost, 0)) DAMAGE_COST,
       max(t.cost) max_cost,
       avg(t.cost) avg_cost
  from INVENTORY_BALANCE t
 where t.year = '&year_i'
   and t.period = '&period'
   and t.part_no in ('SRMO-SMW720MSO',
                     'SRMO-SMW930MCO',
                     'SRMO-SMW825AMSO',
                     'SRMO-SMW925AMGPRO',
                     'SRMO-SMW025-INVERTER-MO',
                     'BOWM-WTE6511BO',
                     'SRTV-SLE55U5GOTV',
                     'SRWM-SWM-FW100AS',
                     'SRSM-SS-HEAD-15CH1',
                     'BOREF-RDNT360E20ZWB',
                     'SRREF-SFT360WB',
                     'SRREF-SFT470WB',
                     'SRREF-SFT340WB',
                     'SRREF-SFT440WB',
                     'BOREF-RDNT440E20ZWB',
                     'SRREF-SINGER-DF2-18-RD',
                     'SRREF-SINGER-DF2-18-RN',
                     'SRREF-SINGER-DD2-29-BG',
                     'SRREF-SINGER-DD2-29-RG',
                     'SRREF-SINGER-FF2-66',
                     'SRREF-SINGER-BD-260-GL-GY',
                     'SRREF-SINGER-BD-380-GL-GY',
                     'SREI-SID129BU',
                     'SREI-SID129GN',
                     'SREI-SID261BU',
                     'SREI-SID261GN',
                     'SREI-SIS253GN',
                     'SREI-SIS253PR',
                     'SREI-SIS277GN',
                     'SREI-SIS277PK',
                     'VGIPS-PRIME-1050')
 group by t.year, t.period, t.site, t.part_no
 order by t.site, t.part_no, t.site, t.part_no
